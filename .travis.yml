language: cpp

matrix:
  include:
      - os: linux
        compiler: gcc
        env: CONFIG=debug_linux BUILD_DIR=Debug

      - os: linux
        compiler: gcc
        env: CONFIG=release_linux BUILD_DIR=Release

      - os: linux
        compiler: clang
        CONFIG=debug_linux BUILD_DIR=Debug

      - os: linux
        compiler: clang
        CONFIG=release_linux BUILD_DIR=Release

git:
  submodules: false

before_install:
    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
    - git submodule update --init --recursive
    - export CXX="g++-5" CC="gcc-5" GCOV="gcov-5"
    - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
    - sudo apt-add-repository --yes ppa:zoogie/sdl2-snapshots  # libsdl2
    - sudo apt-get update
    - sudo apt-get install -qq g++-5
    - sudo apt-get install libsdl2-dev libsdl2-ttf-dev libsdl2-image-dev

before_script:
  - git clone https://github.com/sbx320/premake5-travis.git
  - chmod +x premake5-travis/premake5
  - ./premake5-travis/premake5 gmake

script:
  - make config=$CONFIG all
  - cd build/bin/$BUILD_DIR
  - ./PantsSimTest
  - ./PantsCLexerTest
  - ./PantsCParserTest
